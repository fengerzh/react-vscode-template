# 提交规范

<cite>
**本文档引用的文件**  
- [README.md](file://README.md)
- [package.json](file://package.json)
</cite>

## 目录
1. [简介](#简介)
2. [提交类型详解](#提交类型详解)
3. [提交消息格式规范](#提交消息格式规范)
4. [工具集成与自动化验证](#工具集成与自动化验证)
5. [团队协作执行策略](#团队协作执行策略)
6. [对版本发布的影响](#对版本发布的影响)
7. [最佳实践示例](#最佳实践示例)

## 简介
本指南基于项目中采用的约定式提交（Conventional Commits）规范，旨在为开发团队提供清晰、一致的 Git 提交消息编写标准。通过标准化提交格式，不仅提升代码历史的可读性，还支持自动化生成 CHANGELOG 和语义化版本控制（SemVer），从而提高软件交付的可靠性和效率。

**Section sources**
- [README.md](file://README.md#L1-L173)

## 提交类型详解
每种提交类型具有明确的语义含义和应用场景，确保团队成员能够准确理解每次变更的目的。

### feat：新功能
用于标识新增的功能性代码变更，通常涉及用户可见的新特性或能力扩展。

**应用场景**：添加新的页面、组件、API 接口、用户交互逻辑等。

### fix：修复
表示修复了现有功能中的缺陷或错误，属于问题修正类变更。

**应用场景**：修复 UI 显示异常、逻辑错误、边界条件处理不当等问题。

### docs：文档更新
仅涉及文档内容的修改，不包含源码变更。

**应用场景**：更新 README、API 文档、注释说明、配置说明等。

### style：代码格式
调整代码格式但不影响运行逻辑的变更，如空格、缩进、分号、格式化等。

**应用场景**：使用 Prettier 或 ESLint 自动格式化代码、调整代码排版。

### refactor：重构
在不改变外部行为的前提下对代码结构进行优化和重构。

**应用场景**：函数拆分、变量重命名、模块化改进、消除重复代码。

### perf：性能优化
明确提升系统性能的代码变更，如减少渲染时间、降低内存占用、优化算法复杂度等。

**应用场景**：优化组件渲染性能、减少不必要的计算、引入缓存机制。

### test：测试相关
新增或修改测试用例，包括单元测试、集成测试、E2E 测试等。

**应用场景**：为新功能添加测试、修复测试用例、更新测试配置。

### chore：构建工具或辅助工具变动
与生产代码无关的维护性变更，通常影响开发流程或构建系统。

**应用场景**：更新依赖版本、修改 CI/CD 配置、调整构建脚本、配置 Husky 和 Commitlint。

**Section sources**
- [README.md](file://README.md#L148-L158)

## 提交消息格式规范
提交消息应遵循以下结构：
```
<类型>(<可选范围>): <简短描述>

<详细描述（可选）>

<破坏性变更或备注（可选）>
```

- **类型**：必须是 `feat`, `fix`, `docs`, `style`, `refactor`, `perf`, `test`, `chore` 之一。
- **范围**：可选，用于指定变更影响的模块或组件，如 `(auth)`, `(ui)`, `(store)`。
- **简短描述**：使用动词开头，简洁明了地描述变更内容，建议不超过 72 个字符。
- **详细描述**：换行后提供更详细的上下文信息，解释“为什么”而非“怎么做”。
- **破坏性变更**：以 `BREAKING CHANGE:` 开头，说明不兼容的变更及其迁移方案。

示例：
```
feat(login): 添加用户登录表单验证
fix(ui): 修复首页按钮点击无响应问题
docs: 更新 API 接口文档说明
style: 格式化所有组件文件
refactor(store): 拆分全局状态管理模块
perf: 优化用户列表渲染性能
test: 为用户服务添加单元测试
chore(deps): 升级 axios 至 v1.6.0
```

**Section sources**
- [README.md](file://README.md#L150-L158)

## 工具集成与自动化验证
通过集成 Commitlint 和 Husky 工具链，可在提交时自动校验提交消息是否符合约定式提交规范。

### 配置说明
项目中已通过依赖项引入 `@commitlint/cli` 和 `@commitlint/config-conventional`，并结合 Husky 在 `commit-msg` 钩子中执行校验。

当开发者执行 `git commit` 时，Husky 会触发 Commitlint 对提交消息进行检查，若不符合规范则阻止提交。

### 安装与启用
虽然当前项目未直接在根目录配置 commitlint，但多个依赖包（如 axios、ts-jest）已在其 `package.json` 中配置了 commit-msg 钩子，表明该规范已在生态中广泛使用。

建议在项目根目录创建 `commitlint.config.js` 文件并启用 Husky 钩子以统一团队提交行为。

**Section sources**
- [package.json](file://package.json#L1-L60)
- [README.md](file://README.md#L148-L158)

## 团队协作执行策略
为确保整个团队遵循统一的提交规范，建议采取以下措施：

1. **培训与宣导**：组织团队成员学习约定式提交规范，明确各类别的使用场景。
2. **工具强制校验**：在项目初始化阶段配置 Husky + Commitlint，确保本地提交无法绕过校验。
3. **CI/CD 集成**：在持续集成流程中增加提交消息格式检查，防止不符合规范的提交进入主分支。
4. **代码审查标准**：将提交消息质量纳入 Code Review 检查项，促进良好习惯养成。
5. **模板引导**：提供 `.gitmessage` 模板或使用 `git commit -i` 交互式提交工具辅助编写。

## 对版本发布的影响
约定式提交规范直接支持自动化版本管理和 CHANGELOG 生成：

- **feat** 类型提交将触发 **次版本号递增**（minor）
- **fix** 类型提交将触发 **修订版本号递增**（patch）
- 包含 **BREAKING CHANGE** 的提交将触发 **主版本号递增**（major）
- 其他类型（如 docs、style、chore）默认不触发版本号变更

工具如 `semantic-release` 可根据提交历史自动生成版本号和发布日志，极大提升发布效率与准确性。

**Section sources**
- [README.md](file://README.md#L148-L158)

## 最佳实践示例
以下是符合规范的实际提交消息示例：

```
feat(settings): 添加用户偏好设置功能
允许用户自定义主题颜色和语言选项

- 新增 Settings 页面组件
- 实现 Zustand 状态持久化存储
- 支持深色/浅色主题切换

refactor(auth): 重构登录逻辑为独立服务模块
提取 authentication 相关方法到 services/auth.ts
便于多处复用并提升可测试性

perf(list): 优化用户列表虚拟滚动性能
使用 react-window 替代原生滚动实现
列表渲染帧率从 45fps 提升至 60fps

test(e2e): 增加登录流程的端到端测试
覆盖成功登录、密码错误、网络异常等场景
确保核心流程稳定性

chore(ci): 配置 GitHub Actions 自动化部署
添加 build-and-deploy 工作流
支持 main 分支推送后自动发布

docs: 更新项目启动和部署说明
补充环境变量配置示例
修正依赖安装命令错误
```

这些示例展示了如何结合具体上下文编写清晰、有意义的提交消息，既满足工具解析需求，也便于人类阅读理解。

**Section sources**
- [README.md](file://README.md#L150-L158)